<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¯­è¨€åˆ‡æ¢è°ƒè¯•æµ‹è¯•</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background: #f5f5f5; 
        }
        .test-section { 
            background: white; 
            padding: 20px; 
            margin: 20px 0; 
            border-radius: 8px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
        }
        .lang-btn { 
            background: #007acc; 
            color: white; 
            border: none; 
            padding: 8px 16px; 
            margin: 5px; 
            border-radius: 5px; 
            cursor: pointer; 
        }
        .lang-btn.active { 
            background: #ff6b6b; 
        }
        .lang-btn:hover { 
            background: #005a9e; 
        }
        .test-element { 
            margin: 10px 0; 
            padding: 10px; 
            background: #f0f8ff; 
            border-left: 4px solid #007acc; 
        }
        .debug-info { 
            background: #333; 
            color: #00ff00; 
            padding: 10px; 
            border-radius: 5px; 
            font-family: 'Courier New', monospace; 
            font-size: 12px; 
            white-space: pre-wrap; 
        }
    </style>
</head>
<body>
    <h1>ğŸ” è¯­è¨€åˆ‡æ¢è°ƒè¯•æµ‹è¯•</h1>
    
    <div class="test-section">
        <h2>è¯­è¨€æŒ‰é’®</h2>
        <button class="lang-btn active" data-lang="zh" onclick="testLanguageSwitch('zh')">ä¸­æ–‡</button>
        <button class="lang-btn" data-lang="en" onclick="testLanguageSwitch('en')">English</button>
        <button class="lang-btn" data-lang="ja" onclick="testLanguageSwitch('ja')">æ—¥æœ¬èª</button>
    </div>
    
    <div class="test-section">
        <h2>å¤šè¯­è¨€æµ‹è¯•å…ƒç´ </h2>
        <div class="test-element">
            <strong>æ ‡é¢˜ï¼š</strong><span data-i18n="hero-line1">åˆ›é€ </span>
        </div>
        <div class="test-element">
            <strong>å‰¯æ ‡é¢˜ï¼š</strong><span data-i18n="hero-subtitle">æ¢ç´¢è‰²å½©ä¸å½¢æ€çš„æ— é™å¯èƒ½</span>
        </div>
        <div class="test-element">
            <strong>å¯¼èˆªï¼š</strong><span data-i18n="nav-home">é¦–é¡µ</span> | <span data-i18n="nav-about">å…³äº</span> | <span data-i18n="nav-gallery">ä½œå“</span>
        </div>
        <div class="test-element">
            <strong>è‰ºæœ¯å®¶ï¼š</strong><span data-i18n="artist-name">æ—å£«æ—</span>
        </div>
    </div>
    
    <div class="test-section">
        <h2>è°ƒè¯•ä¿¡æ¯</h2>
        <div id="debug-output" class="debug-info">ç­‰å¾…è°ƒè¯•ä¿¡æ¯...</div>
    </div>
    
    <div class="test-section">
        <h2>æ‰‹åŠ¨æµ‹è¯•</h2>
        <button onclick="manualTest()">æ‰‹åŠ¨æµ‹è¯•è¯­è¨€åˆ‡æ¢</button>
        <button onclick="checkStatus()">æ£€æŸ¥å½“å‰çŠ¶æ€</button>
        <button onclick="clearDebug()">æ¸…ç©ºè°ƒè¯•</button>
    </div>

    <!-- å¼•å…¥å…³é”®è„šæœ¬ -->
    <script src="./js/debug-monitor.js"></script>
    <script src="./js/i18n.js"></script>
    
    <script>
        let debugOutput = [];
        
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            const logMessage = `[${timestamp}] ${message}`;
            debugOutput.push(logMessage);
            document.getElementById('debug-output').textContent = debugOutput.join('\n');
            console.log(logMessage);
        }
        
        function testLanguageSwitch(lang) {
            log(`ğŸ”„ æµ‹è¯•åˆ‡æ¢åˆ°è¯­è¨€: ${lang}`);
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-lang') === lang) {
                    btn.classList.add('active');
                }
            });
            
            // æ£€æŸ¥switchLanguageå‡½æ•°æ˜¯å¦å­˜åœ¨
            if (typeof window.switchLanguage === 'function') {
                log(`âœ… æ‰¾åˆ°switchLanguageå‡½æ•°ï¼Œå¼€å§‹åˆ‡æ¢åˆ°${lang}`);
                try {
                    window.switchLanguage(lang);
                    
                    // éªŒè¯åˆ‡æ¢ç»“æœ
                    setTimeout(() => {
                        const currentLang = window.currentLanguage;
                        const testElement = document.querySelector('[data-i18n="hero-line1"]');
                        const testText = testElement ? testElement.textContent : 'æœªæ‰¾åˆ°';
                        
                        log(`ğŸ“Š åˆ‡æ¢ç»“æœï¼šé¢„æœŸ${lang}ï¼Œå®é™…${currentLang}ï¼Œæµ‹è¯•æ–‡æœ¬ï¼š"${testText}"`);
                        
                        if (currentLang === lang) {
                            log(`ğŸ‰ è¯­è¨€åˆ‡æ¢æˆåŠŸï¼`);
                        } else {
                            log(`âŒ è¯­è¨€åˆ‡æ¢å¤±è´¥`);
                        }
                    }, 1000);
                } catch (error) {
                    log(`âŒ è¯­è¨€åˆ‡æ¢å‡ºé”™: ${error.message}`);
                }
            } else {
                log(`âŒ æœªæ‰¾åˆ°switchLanguageå‡½æ•°`);
                log(`å¯ç”¨çš„å…¨å±€å‡½æ•°: ${Object.keys(window).filter(k => k.includes('switch') || k.includes('Language') || k.includes('i18n')).join(', ')}`);
            }
        }
        
        function manualTest() {
            log(`ğŸ§ª å¼€å§‹æ‰‹åŠ¨æµ‹è¯•...`);
            log(`å½“å‰é¡µé¢è¯­è¨€: ${document.documentElement.lang}`);
            log(`localStorageä¸­çš„è¯­è¨€: ${localStorage.getItem('preferredLanguage')}`);
            log(`window.currentLanguage: ${window.currentLanguage}`);
            log(`å¤šè¯­è¨€å…ƒç´ æ•°é‡: ${document.querySelectorAll('[data-i18n]').length}`);
            log(`è¯­è¨€æŒ‰é’®æ•°é‡: ${document.querySelectorAll('.lang-btn').length}`);
            
            // æµ‹è¯•æ•°æ®æ˜¯å¦åŠ è½½
            if (typeof window.i18nData !== 'undefined') {
                log(`âœ… i18nDataå·²åŠ è½½ï¼Œæ”¯æŒè¯­è¨€: ${Object.keys(window.i18nData).join(', ')}`);
            } else if (typeof i18n !== 'undefined') {
                log(`âœ… i18nå·²åŠ è½½ï¼Œæ”¯æŒè¯­è¨€: ${Object.keys(i18n).join(', ')}`);
            } else {
                log(`âŒ å¤šè¯­è¨€æ•°æ®æœªåŠ è½½`);
            }
        }
        
        function checkStatus() {
            log(`ğŸ“‹ å½“å‰çŠ¶æ€æ£€æŸ¥:`);
            
            const activeBtn = document.querySelector('.lang-btn.active');
            const activeLang = activeBtn ? activeBtn.getAttribute('data-lang') : 'æ— ';
            log(`æ´»åŠ¨è¯­è¨€æŒ‰é’®: ${activeLang}`);
            
            const testElements = document.querySelectorAll('[data-i18n]');
            testElements.forEach((el, index) => {
                const key = el.getAttribute('data-i18n');
                const text = el.textContent;
                const isProtected = el.getAttribute('data-profile-updated') === 'true';
                log(`[${index}] ${key}: "${text}" (ä¿æŠ¤: ${isProtected})`);
            });
        }
        
        function clearDebug() {
            debugOutput = [];
            document.getElementById('debug-output').textContent = 'è°ƒè¯•ä¿¡æ¯å·²æ¸…ç©º';
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨æµ‹è¯•
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                log(`ğŸ“± é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹è‡ªåŠ¨æ£€æŸ¥`);
                manualTest();
            }, 1000);
        });
        
        // ç›‘å¬è¯­è¨€åˆ‡æ¢äº‹ä»¶
        if (typeof window.debugMonitor !== 'undefined') {
            log(`âœ… è°ƒè¯•ç›‘æ§ç³»ç»Ÿå·²åŠ è½½`);
        }
        
        // 5ç§’åè‡ªåŠ¨æµ‹è¯•è¯­è¨€åˆ‡æ¢
        setTimeout(() => {
            log(`â° è‡ªåŠ¨æµ‹è¯•ï¼š5ç§’ååˆ‡æ¢åˆ°è‹±è¯­`);
            testLanguageSwitch('en');
        }, 5000);
    </script>
</body>
</html>